------------------------------------------------------------------------
-- TIPOS E DADOS
------------------------------------------------------------------------

N = 3
ids = { 1..N }
datatype produto =  notebook | tablet | celular
valor = { 4, 8 }

------------------------------------------------------------------------
-- CANAIS
------------------------------------------------------------------------

channel vender : ids.produto.valor
channel comprar : ids.produto

------------------------------------------------------------------------
-- AGENTE
------------------------------------------------------------------------

AGENTE(id, produto, valor) = 
					
					vender!id!produto!valor -> AGENTE(id, produto, valor)
				[]

					comprar!id!produto -> AGENTE(id, produto, valor)


AGENTES = ||| id:ids, p:produto, v:valor @ AGENTE(id, p, v) 
------------------------------------------------------------------------
-- VENDA_ON_LINE
------------------------------------------------------------------------

VENDA(produto, valor) = 
								
								vender?vendedor?produto?valor -> VENDA(produto, valor)
							[]
								comprar?comprador?prod -> if( produto != prod ) then 

															VENDA(produto, valor)

														  else 

														  	LEILAO(produto, valor, {comprador})

VENDAS_ON_LINE = ||| p:produto, v:valor @ VENDA(p, v)


LEILAO(produto, valor, compradores) = SKIP



assert AGENTES [|{|vender, comprar|}|] VENDAS_ON_LINE  :[deadlock free] 
assert AGENTES [|{|vender, comprar|}|] VENDAS_ON_LINE  :[deterministic] 

------------------------------------------------------------------------
-- SYNC
------------------------------------------------------------------------ 
